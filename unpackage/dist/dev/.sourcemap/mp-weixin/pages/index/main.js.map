{"version":3,"sources":["uni-app:///main.js",null,"webpack:///E:/小程序/uniappWeather/pages/index/main.vue?62e0","webpack:///E:/小程序/uniappWeather/pages/index/main.vue?2932","webpack:///E:/小程序/uniappWeather/pages/index/main.vue?7fe7","uni-app:///pages/index/main.vue","webpack:///E:/小程序/uniappWeather/pages/index/main.vue?5d9d","webpack:///E:/小程序/uniappWeather/pages/index/main.vue?0a57"],"names":["createPage","Page"],"mappings":";;;;;;;;;;;;;;;;;;;;kDAAA;AACA;AACA,0F;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACqC;;;AAGxF;AACgK;AAChK,gBAAgB,6KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9BA;AAAA;AAAA;AAAA;AAAklB,CAAgB,8mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgGtmB,kD;;AAEA;AACA;AACA;AACA,yC;AACA;AACA,MADA,kBACA;AACA;AACA,qBADA;AAEA,kBAFA;AAGA,oBAHA;AAIA,kBAJA;AAKA,wBALA;AAMA;AACA,qBAPA;AAQA;AACA,sBATA;AAUA;AACA,kBAXA;AAYA;AACA;AACA,kBADA;AAEA;AACA,oCADA,EAFA,EADA;;;AAOA;AACA,kBADA;AAEA;AACA,oCADA,EAFA,EAPA,CAZA;;;;AA0BA,uBA1BA;AA2BA,sBA3BA;;AA6BA,GA/BA;AAgCA;AACA,yBADA,EACA,+BADA,EACA,uCADA,EAhCA;;AAmCA,QAnCA,oBAmCA;AACA;AACA;AACA,kBADA;;AAGA,GAxCA;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBADA,EACA;AACA,8BAFA,EAEA;AACA;AACA;AACA;AACA;AACA,OAPA;AAQA;AACA;AACA;AACA,OAXA;;AAaA,GA5DA;AA6DA,mBA7DA,+BA6DA;AACA;AACA,GA/DA;AAgEA,QAhEA,oBAgEA;AACA;AACA;AACA;AACA;AACA,GArEA;AAsEA;AACA;AACA,eAFA,yBAEA;AACA;AACA;AACA;AACA,SAHA;;AAKA,KARA;AASA,eATA,yBASA;AACA;AACA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA,SAPA;;AASA,KAnBA;AAoBA,oBApBA,8BAoBA;AACA;AACA,mCADA;AAEA;AACA;AACA,SAJA;AAKA,YALA,kBAKA;AACA;AACA,SAPA;;AASA,KA9BA;AA+BA,mBA/BA,6BA+BA;AACA;AACA,qBADA;AAEA;AACA;AACA;AACA,qCADA;AAEA,uCAFA,EADA;;AAKA;AACA;AACA,kHADA;;AAGA;AACA;AACA,aAXA;AAYA;AACA;AACA,aAdA;;AAgBA,SAnBA;;AAqBA,KArDA;AAsDA,cAtDA,sBAsDA,QAtDA,EAsDA,EAtDA,EAsDA;AACA;AACA,UADA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDADA;AAEA,kDAFA;AAGA,kDAHA;AAIA,6CAJA;AAKA,kDALA;AAMA,oCANA;AAOA,qDAPA;AAQA,0CARA;AASA,gCATA;;AAWA,iDAXA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCADA,EADA;;AAIA;AACA;AACA,iBANA;;AAQA;AACA;AACA;AACA;AACA,uCADA,EADA;;AAIA;AACA;AACA,iBANA;;AAQA;AACA,WAvBA;;AAyBA,OApDA;AAqDA,KA5GA;AA6GA;AACA,cA9GA,sBA8GA,KA9GA,EA8GA;AACA;AACA,4KADA;;AAGA,KAlHA;AAmHA,gBAnHA,0BAmHA;AACA;AACA,oCADA;AAEA,0CAFA;AAGA,wCAHA;AAIA,8BAJA;AAKA,sCALA;AAMA,sCANA;AAOA,wCAPA;AAQA,sCARA;AASA,wCATA;AAUA,4BAVA;;AAYA;AACA,6EADA;;AAGA,KAnIA;AAoIA,WApIA,qBAoIA;AACA;AACA,2CADA;;AAGA;AACA;AACA,OAFA,EAEA,IAFA;AAGA,KA3IA;AA4IA,aA5IA,kCA4IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAHA;;AAKA,SAPA;;AASA,KAvJA;AAwJA,eAxJA,uBAwJA,IAxJA,EAwJA,EAxJA,EAwJA;AACA;AACA;AACA;AACA,KA5JA;AA6JA,cA7JA,wBA6JA;AACA;AACA;AACA;AACA;AACA,SAHA;;AAKA,KApKA,EAtEA,E;;;;;;;;;;;;;;;ACtGA;AAAA;AAAA;AAAA;AAAu3B,CAAgB,23BAAG,EAAC,C;;;;;;;;;;ACA34B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/main.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/main.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./main.vue?vue&type=template&id=3120bf0f&scoped=true&\"\nvar renderjs\nimport script from \"./main.vue?vue&type=script&lang=js&\"\nexport * from \"./main.vue?vue&type=script&lang=js&\"\nimport style0 from \"./main.vue?vue&type=style&index=0&id=3120bf0f&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3120bf0f\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/main.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./main.vue?vue&type=template&id=3120bf0f&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.cityhistory, function(item, index) {\n    var $orig = _vm.__get_orig(item)\n\n    var g0 = item.data.city.split(\",\")\n    var g1 = item.data.city.split(\",\")\n    return {\n      $orig: $orig,\n      g0: g0,\n      g1: g1\n    }\n  })\n\n  var g2 = _vm.weathermsg ? Object.values(_vm.dateweather) : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        g2: g2\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./main.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./main.vue?vue&type=script&lang=js&\"","<template>\r\n\t<div class=\"index\">\r\n\t\t<div class=\"indexbox\">\r\n\t\t\t<div class=\"localtion\">\r\n\t\t\t\t<div \r\n\t\t\t\tv-if='!!region'\r\n\t\t\t\t@click='opendrawer' \r\n\t\t\t\tstyle='height:100%;display: flex;justify-content: center;align-items: center;'>\r\n\t\t\t\t\t<icon type=\"search\" size=\"18\" color='#666' style=\"height:20px;\"></icon>\r\n\t\t\t\t\t{{region}}\r\n\t\t\t\t</div>\r\n\t\t\t\t<uni-drawer ref=\"unidrawer\">\r\n\t\t\t\t\t<div style='height:40px;background:#333;'>\r\n\t\t\t\t\t\t<div  style='height: 40px;width: calc(100% - 40px);float: left;text-align: left;color:#fff;font-size:15px;text-indent:10px;'>搜索城市</div>\r\n\t\t\t\t\t\t<icon type=\"search\" size=\"20\" color='#fff' style=\"float: right;width: 40px;height:30px;padding-top: 10px;\" @click=\"tocitys\"></icon>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<scroll-view style='height:calc(100% - 40px)' scroll-y> \r\n\t\t\t\t\t\t\t<uni-swipe-action>\r\n\t\t\t\t\t\t\t\t<uni-swipe-action-item \r\n\t\t\t\t\t\t\t\t:right-options=\"options\" \r\n\t\t\t\t\t\t\t\tv-for=\"(item,index) in cityhistory\" \r\n\t\t\t\t\t\t\t\t:key='index'\r\n\t\t\t\t\t\t\t\t@click='bindClick($event,item)'\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<view style=\"display: flex;width: 100%;\" @click.stop=\"closedrawer(item.data.city,item._id)\">\r\n\t\t\t\t\t\t\t\t\t\t<div style='flex:70%;text-align:left;text-indent:10px;font-size:15px;'>{{item.data.city.split(',')[item.data.city.split(',').length-1]}}</div>\r\n\t\t\t\t\t\t\t\t\t\t<div style='flex:30%;text-align:left;font-size:15px;'>\r\n\t\t\t\t\t\t\t\t\t\t\t{{item.data.temp}}℃\r\n\t\t\t\t\t\t\t\t\t\t\t<image :src=\"'/static/weathercn/'+item.data.img+'.png'\" mode=\"\" style=\"width: 25px;height: 25px;margin-top: 10px; float: right;\"></image>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</uni-swipe-action-item>\r\n\t\t\t\t\t\t\t</uni-swipe-action>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</uni-drawer>\r\n\t\t\t</div>\r\n\t\t\t<div class='showrequest' v-if='weathermsg'>\r\n\t\t\t\t<div class='data_weather'  v-if=\"!!Object.values(dateweather).length\" @click=\"totodydetail\">\r\n\t\t\t\t\t<div class='now_weather'>\r\n\t\t\t\t\t\t<div class='temperature'>{{dateweather.current_temperature}}℃</div>\r\n\t\t\t\t\t\t<div class='wind'>{{dateweather.wind_direction}} {{dateweather.wind_level}} 湿度:{{dateweather.humidity}}%</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class='condition'>{{dateweather.current_condition}}</div>\r\n\t\t\t\t\t<div class=\"quality\" :style=\"'background:'+dateweather.background\">{{dateweather.quality_level}}    {{dateweather.aqi}}</div>\r\n\t\t\t\t\t<image style='width:70px;height:70px;' :src=\"'/static/weathercn/'+dateweather.img+'.png'\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!-- 今明两天天气 -->\r\n\t\t\t\t<div class='tomorrow_weather' v-if=\"twodateweather.length\">\r\n\t\t\t\t\t<swiper display-multiple-items=\"1\" duration=\"500\" :circular='true'>\r\n\t\t\t\t\t  <block v-for=\"(item,index) in twodateweather\" :key=\"index\">\r\n\t\t\t\t\t\t<swiper-item>\r\n\t\t\t\t\t\t\t<div>{{item.week}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.day.weather==item.night.weather? item.day.weather:item.day.weather+'转'+item.night.weather}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.night.templow}}/{{item.day.temphigh}}℃</div>\r\n\t\t\t\t\t\t\t<div>{{item.day.winddirect=='持续无风向'? '微风':item.day.winddirect}}</div>\r\n\t\t\t\t\t\t</swiper-item>\r\n\t\t\t\t\t  </block>\r\n\t\t\t\t\t</swiper>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!-- 一周天气 -->\r\n\t\t\t\t<div class='halfmonth' v-if=\"forecastlist.length\">\r\n\t\t\t\t\t<swiper display-multiple-items=\"3\" duration=\"500\">\r\n\t\t\t\t\t  <block v-for=\"(item,index) in forecastlist\" :key=\"index\">\r\n\t\t\t\t\t\t<swiper-item @click=\"gotodetail(index)\">\r\n\t\t\t\t\t\t\t<div>{{item.week}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.date}}</div>\r\n\t\t\t\t\t\t\t<div style='font-size:13px;'>{{item.day.weather==item.night.weather? item.day.weather:item.day.weather+'转'+item.night.weather}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.night.templow}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.day.temphigh}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.day.winddirect=='持续无风向'? '微风':item.day.winddirect}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.day.windpower==item.night.windpower? item.day.windpower:item.day.windpower+'转'+item.night.windpower}}</div>\r\n\t\t\t\t\t\t</swiper-item>\r\n\t\t\t\t\t  </block>\r\n\t\t\t\t\t</swiper>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!-- 24小时天气 -->\r\n\t\t\t\t<div class=\"hour\" v-if=\"hourlist.length\">\r\n\t\t\t\t\t<swiper display-multiple-items=\"6\" interval=\"500\" duration=\"500\">\r\n\t\t\t\t\t  <block v-for=\"(item,index) in hourlist\" :key=\"index\">\r\n\t\t\t\t\t\t<swiper-item>\r\n\t\t\t\t\t\t\t<div>{{item.condition}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.temperature}}</div>\r\n\t\t\t\t\t\t\t<div>{{item.hour}}</div>\r\n\t\t\t\t\t\t</swiper-item>\r\n\t\t\t\t\t  </block>\r\n\t\t\t\t\t</swiper>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"noweathermsg\" style='height: calc(100% - 40px);text-align: center;line-height: 100px;font-size: 18px;' v-else>\r\n\t\t\t\t当前城市天气查询失败\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport {request} from 'utils';\r\nimport {uniDrawer,uniSwipeAction,uniSwipeActionItem} from \"@dcloudio/uni-ui\";\r\n//初始化数据库\r\nwx.cloud.init();\r\nconst db = wx.cloud.database({});\r\nconst citylist = db.collection('citylist');\r\nexport default {\r\n  data () {\r\n    return {\r\n\t\tlifeindex:null,\r\n\t\tresult:null,\r\n\t\tlistdata:null,\r\n\t\tregion:null,\r\n\t\ttwodateweather:[],\r\n\t\t// 今天天气信息\r\n\t\tdateweather:{},\r\n\t\t// 15天天气\r\n\t\tforecastlist:[],\r\n\t\t// 24小时天气\r\n\t\thourlist:[],\r\n\t\toptions: [\r\n\t\t\t{\r\n\t\t\t\ttext: '取消',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tbackgroundColor: '#007aff'\r\n\t\t\t\t}\r\n\t\t\t}, \r\n\t\t\t{\r\n\t\t\t\ttext: '删除',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tbackgroundColor: '#dd524d'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t],\r\n\t\tcityhistory:null,\r\n\t\tweathermsg:true\r\n    }\r\n  },\r\n  components:{\r\n\t  uniDrawer,uniSwipeAction,uniSwipeActionItem\r\n  },\r\n  onLoad(){\r\n    this.GetLocation();\r\n\twx.showLoading({\r\n\t  title: '加载中',\r\n\t})\r\n  },\r\n  //转发分享\r\n  onShareAppMessage: function(ops) {\r\n    if (ops.from === \"button\") {\r\n      // 来自页面内转发按钮\r\n      console.log(ops.target);\r\n    }\r\n    return {\r\n      title: \"天气\",//这里是定义转发的标题\r\n      path: `pages/index/main`,//这里是定义转发的地址\r\n      success: function(res) {\r\n        // 转发成功\r\n        console.log(\"转发成功:\" + JSON.stringify(res));\r\n        var shareTickets = res.shareTickets;\r\n      },\r\n      fail: function(res) {\r\n        // 转发失败\r\n        console.log(\"转发失败:\" + JSON.stringify(res));\r\n      }\r\n    };\r\n  },\r\n  onPullDownRefresh () {\r\n\tthis.GetLocation();\r\n  },\r\n  onShow() {\r\n  \tif(!!this.vuex.state.choosecity){\r\n\t\tthis.region = this.vuex.state.choosecity.province;\r\n\t\tthis.getweather(this.vuex.state.choosecity.province)\r\n\t}\r\n  },\r\n  methods: {\r\n\t//初始化时加载查询过的历史数据\r\n\tgetlinelist(){\r\n\t    linelist.get({\r\n\t        success:res=>{\r\n\t            this.checkpoint = res.data;\r\n\t        }\r\n\t    })\r\n\t},  \r\n\tGetLocation(){\r\n\t\twx.getSetting({\r\n\t\t\tsuccess:res=>{\t\t\t\r\n\t\t\t\tif (!JSON.stringify(res.authSetting).includes('scope.userLocation')) {  //3.1 每次进入程序判断当前是否获得授权，如果没有就去获得授权，如果获得授权，就直接获取当前地理位置\r\n\t\t\t\t\tthis.getAuthorizeInfo()\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.getLocationInfo()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tgetAuthorizeInfo(){  //1. uniapp弹窗弹出获取授权（地理，个人微信信息等授权信息）弹窗\r\n\t\twx.authorize({\r\n\t\t\tscope: \"scope.userLocation\",\r\n\t\t\tsuccess:res=>{ //1.1 允许授权\r\n\t\t\t\tthis.getLocationInfo();\r\n\t\t\t},\r\n\t\t\tfail(){    //1.2 拒绝授权\r\n\t\t\t\tconsole.log(\"你拒绝了授权，无法获得周边信息\")\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\tgetLocationInfo(){  //2. 获取地理位置\r\n\t\twx.getLocation({\r\n\t\t\ttype: 'wgs84',\r\n\t\t\tsuccess:data=> {\r\n\t\t\t\tthis.qqmapsdk.reverseGeocoder({\r\n\t\t\t\t  location: {\r\n\t\t\t\t    latitude: data.latitude,\r\n\t\t\t\t    longitude: data.longitude\r\n\t\t\t\t  },\r\n\t\t\t\t  success: (res) =>{\r\n\t\t\t\t\t   if(res.result.address_component.province==res.result.address_component.city)\r\n\t\t\t\t\t  \t\tthis.region = res.result.address_component.province+','+res.result.address_component.district;\r\n\t\t\t\t\t   else\r\n\t\t\t\t\t  \t\tthis.region = res.result.address_component.province+','+res.result.address_component.city+','+res.result.address_component.district;\r\n\t\t\t\t    this.getweather(this.region);\r\n\t\t\t\t  },\r\n\t\t\t\t  fail:  (err) => {\r\n\t\t\t\t    console.log(err);\r\n\t\t\t\t  }\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n    getweather(position,id){\r\n\t\trequest('https://jisutqybmf.market.alicloudapi.com/weather/query?city='+position.split(',')[position.split(',').length-1],{'Authorization':'APPCODE def0b8f2c0304cb59b0a7cdaa24dd000' })\r\n\t\t.then(res=>{\r\n\t\t\tif(res.statusCode!=200){\r\n\t\t\t\tthis.weathermsg = false;\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tthis.weathermsg = true;\r\n\t\t\twx.hideLoading();\r\n\t\t\tthis.result =  res.data.result;\r\n\t\t\tthis.lifeindex = this.result.index;\r\n\t\t\tthis.twodateweather= this.result.daily.slice(0,2)\r\n\t\t\tthis.dateweather={\r\n\t\t\t  current_temperature: this.result.temp,\r\n\t\t\t  current_condition: this.result.weather,\r\n\t\t\t  wind_direction: this.result.winddirect,\r\n\t\t\t  wind_level: this.result.windpower,\r\n\t\t\t  quality_level: this.result.aqi.quality,\r\n\t\t\t  aqi: this.result.aqi.aqi,\r\n\t\t\t  background:this.result.aqi.aqiinfo.color,\r\n\t\t\t  humidity:this.result.humidity,\r\n\t\t\t  img:this.result.img\r\n\t\t\t},\r\n\t\t\tthis.forecastlist = this.result.daily;\r\n\t\t\tthis.hourlist = this.result.hourly.map(o=>Object.assign({},{'condition': o.weather,'hour':o.time,'temperature':o.temp}))\r\n\t\t\twx.stopPullDownRefresh();\r\n\t\t\t//储存城市天气历史记录\r\n\t\t\tthis.listdata = {city:position,temp:this.result.temp,img:this.result.img};\r\n\t\t\tcitylist.get({\r\n\t\t\t    success:res=>{\r\n\t\t\t\t\t// 没有历史结果就保存,有历史结果就更新\r\n\t\t\t        if(!res.data.map(o=>o.data).some(o=>o.city==this.listdata.city)){\r\n\t\t\t            citylist.add({\r\n\t\t\t                data:{\r\n\t\t\t                    data:this.listdata\r\n\t\t\t                },\r\n\t\t\t                success: function(res) {\r\n\t\t\t                    console.log(res._id)\r\n\t\t\t                }\r\n\t\t\t            })\r\n\t\t\t        }\r\n\t\t\t\t\tif(!!id && !(!res.data.map(o=>o.data).some(o=>o.city==this.listdata.city))){\r\n\t\t\t\t\t\tcitylist.doc(id).update({\r\n\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t    data:this.listdata\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess:res=>{\r\n\t\t\t\t\t\t\t\tconsole.log(res_id)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t    }\r\n\t\t\t})\r\n\t\t})\r\n    },\r\n    //去到详情页\r\n    gotodetail(index){\r\n\t\twx.navigateTo({\r\n\t\t\turl:`../../pages/weatherdetail/main?data=${JSON.stringify(this.forecastlist)}&lifeindex=${JSON.stringify(this.lifeindex)}&index=${index}`\r\n\t\t})\r\n    },\r\n    totodydetail(){\r\n\t\tlet data = {\r\n\t\t\tweather:this.result.weather,\r\n\t\t\twinddirect:this.result.winddirect,\r\n\t\t\twindpower:this.result.windpower,\r\n\t\t\ttemp:this.result.temp,\r\n\t\t\tpressure:this.result.pressure,\r\n\t\t\thumidity:this.result.humidity,\r\n\t\t\tquality:this.result.aqi.quality,\r\n\t\t\tipm2_5:this.result.aqi.ipm2_5,\r\n\t\t\taqi:this.result.index[0].detail,\r\n\t\t\timg:this.result.img\r\n\t\t}\r\n\t\twx.navigateTo({\r\n\t\t\turl:`../../pages/todydetail/main?data=${JSON.stringify(data)}`\r\n\t\t})\r\n    },\r\n\ttocitys(){\r\n\t\twx.navigateTo({\r\n\t\t\turl:'../../pages/selectcitys/main'\r\n\t\t})\r\n\t\tsetTimeout(()=>{\r\n\t\t\tthis.$refs.unidrawer.close();\r\n\t\t},1000)\r\n\t},\r\n\tbindClick({content},{_id}){\r\n\t\tif(content.text != '删除') return;\r\n\t\tcitylist.doc(_id).remove({\r\n\t\t    success: (res) => {\r\n\t\t\t\tcitylist.get({\r\n\t\t\t\t\tsuccess:res=>{\r\n\t\t\t\t\t\tthis.cityhistory = res.data;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t    }\r\n\t\t})\r\n\t},\r\n\tclosedrawer(data,id){\r\n\t\tthis.getweather(data,id);\r\n\t\tthis.region = data;\r\n\t\tthis.$refs.unidrawer.close();\r\n\t},\r\n\topendrawer(){\r\n\t\tthis.$refs.unidrawer.open();\r\n\t\tcitylist.get({\r\n\t\t\tsuccess:res=>{\r\n\t\t\t\tthis.cityhistory = res.data;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n\t@import 'index.css';\r\n</style>","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./main.vue?vue&type=style&index=0&id=3120bf0f&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./main.vue?vue&type=style&index=0&id=3120bf0f&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1604479164263\n      var cssReload = require(\"E:/小程序/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}